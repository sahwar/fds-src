#
# Copyright 2015 Formation Data Systems, Inc.
#
# Test QoS behavior.
#

[user]
user_name = root
password = passwd

[node1]
om = true
ip = localhost
fds_root = /fds/node1
fds_port = 7000

[scenario_install]
log_marker = Install the domain
script = [domain]
action = install

[scenario_limit_min_iops]
log_marker = Change platform.conf node_iops_min
script = [testcases.TestFDSEnvMgt.TestModifyPlatformConf]
param_names = current_string,replace_string
params = node_iops_min\s*=.*,node_iops_min = 120

# As long as this remains a single node test, this will
# have to be in here.
[scenario_conf_replica_factor]
log_marker      = Change platform.conf
script          = [testcases.TestFDSEnvMgt.TestModifyPlatformConf]
param_names     = current_string,replace_string
params          = replica_factor.*,replica_factor = 1

[scenario_limit_max_iops]
log_marker = Change platform.conf node_iops_max
script = [testcases.TestFDSEnvMgt.TestModifyPlatformConf]
param_names = current_string,replace_string
params = node_iops_max\s*=.*,node_iops_max = 120

[scenario_start_domain]
log_marker = Start a single-node domain
script = [node1]
action = boot-activate

[scenario_verify_domain_is_up]
log_marker = Verify the node is up and ready
script = [verify]
state = up
fds_nodes = node1

[scenario_test_rate_limit]
log_marker = Testing QoS rate limiting
script = [testcases.TestQoS.TestQosRateLimit]

[scenario_test_assured_rate]
log_marker = Testing QoS assured rates
script = [testcases.TestQoS.TestQosAssured]

[scenario_cleanup]
log_marker = Kill and uninstall the domain
script = [domain]
action = kill-uninst
delay_wait = 120

[scenario_verify_down]
log_marker = Ensure we've cleaned up after ourselves
script = [verify]
state = down
fds_nodes = node1

