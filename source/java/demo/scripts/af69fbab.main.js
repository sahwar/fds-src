window.fdsDemo={Models:{},Collections:{},Views:{},Routers:{},Charts:{},init:function(){"use strict";this.app=new this.Views.ApplicationView,$(".main").append(this.app.$el),this.app.render()}},$(document).ready(function(){"use strict";fdsDemo.init()}),this.JST=this.JST||{},this.JST["app/scripts/templates/adapter.jst"]=function(obj){obj||(obj={});{var __t,__p="";_.escape,Array.prototype.join}with(obj)_.each(model.buttons,function(a){__p+="\n  ",__p+=model.get("type")===a.type?'\n    <button type="button" name="'+(null==(__t=a.type)?"":__t)+'" class="btn btn-fds active">'+(null==(__t=a.name)?"":__t)+"</button>\n  ":'\n    <button type="button" name="'+(null==(__t=a.type)?"":__t)+'" class="btn btn-fds"> '+(null==(__t=a.name)?"":__t)+"</button>\n  ",__p+="\n"}),__p+="\n";return __p},this.JST["app/scripts/templates/application.jst"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<div id="sections" class="container-fluid"></div>\n';return __p},this.JST["app/scripts/templates/flow.jst"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<div class="ioflow"></div>\n';return __p},this.JST["app/scripts/templates/header.jst"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<div class="col-md-5 col-xs-12 header-branding">\n	<div class="header-branding-wrapper clearfix">\n	  <div class="logo"></div>\n	  <div class="title">\n		  <span>Concurrent Read/Write</span>\n		  <br />\n		  <span>Performance Monitor</span>\n	  </div>\n  </div>\n</div>\n<div class="col-md-3 col-xs-12 header-adapter">\n  <div id="adapter-container" class="btn-group clearfix">\n    <!-- the adapter template is inserted here -->\n  </div>\n</div>\n<div class="col-md-4 col-xs-12 header-search">\n	<div id="search-container">\n    <!-- the search template is inserted here -->\n  </div>\n</div>\n';return __p},this.JST["app/scripts/templates/image_item.jst"]=function(obj){obj||(obj={});{var __t,__p="";_.escape}with(obj)__p+='<div class="io-item pull-left">\n  <img src="'+(null==(__t=model.url)?"":__t)+'">\n</div>\n';return __p},this.JST["app/scripts/templates/read_graph.jst"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<div id="read-graph"></div>\n';return __p},this.JST["app/scripts/templates/search.jst"]=function(obj){obj||(obj={});{var __t,__p="";_.escape}with(obj)__p+='<form id="search">\n  <div class="input-group">\n    <input name="q" type="text" class="form-control" placeholder="'+(null==(__t=displayText)?"":__t)+'">\n    <span class="input-group-btn">\n      <button class="btn search" type="submit"> Get <span class="glyphicon glyphicon-search"></span></button>\n   </span>\n  </div>\n</form>\n';return __p},this.JST["app/scripts/templates/section.jst"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<section class="col-xs-12">\n	<div class="settings clearfix"></div>\n	<div class="image-carousel"></div>\n	<div class="graphs"></div>\n</section>\n';return __p},this.JST["app/scripts/templates/settings_view.jst"]=function(obj){obj||(obj={});{var __t,__p="";_.escape}with(obj)__p+='<span class="title">'+(null==(__t=model.get("title"))?"":__t)+'</span>\n<div class="slider-container">\n  <input class="slider" type="text" data-slider-min="0" data-slider-max="'+(null==(__t=model.get("max_value"))?"":__t)+'" data-slider-step="1" data-slider-value="'+(null==(__t=model.get("value"))?"":__t)+'" />\n	<span class="threads">\n	  <span class="value">'+(null==(__t=model.get("value"))?"":__t)+"</span>\n  	Thread"+(null==(__t=1===model.get("value")?"":"s")?"":__t)+"\n  </span>\n</div>\n";return __p},fdsDemo.Utils=fdsDemo.Utils||{},function(){"use strict";fdsDemo.Utils.Timer=function(){this.initialize.apply(this,_.toArray(arguments))},fdsDemo.Utils.Timer.extend=Backbone.Model.extend,_.extend(fdsDemo.Utils.Timer.prototype,Backbone.Events,{initialize:function(a){_.extend(this,_.pick(a||{},"interval")),_.bindAll(this,"runTimer","clearTimer","trigger"),this.interval=this.interval||1e4},setInterval:function(a){this.interval=a},startTimer:function(){this.started||(this.started=!0,this.runTimer())},runTimer:function(){this.started&&(this.clearTimer(),this.timer=setTimeout(this.runTimer,this.interval),_.defer(this.trigger,"tick"))},clearTimer:function(){clearTimeout(this.timer)},stopTimer:function(){this.clearTimer(),this.started=!1}})}(),fdsDemo.Utils=fdsDemo.Utils||{},function(){function a(a){this.multiSwitchedTimer=a}function b(a){return a&&a.running()}function c(a,b,c){_.each(b,function(b){c[b]=_.bind(a[b],a)})}function d(a,b){var c=[].slice.call(arguments,2);_.each(a,function(a){a[b].apply(a,c)})}function e(a,b,c){_.each(b,function(b){c[b]=_.partial(d,a,b)})}function f(a){this.timer=a,this.timerDelegators=[],this.buildTimerDelegator()}function g(a){this.timers=a;var b=_.map(a,_.functions),c=_.uniq(_.reduce(b,function(a,b){return a.concat(b)}));e(this.timers,c,this)}a.extend=Backbone.Model.extend,_.extend(a.prototype,{stopTimer:function(){this._running=!1,this.multiSwitchedTimer.stop(this)},startTimer:function(){this._running=!0,this.multiSwitchedTimer.start(this)},running:function(){return!!this._running}}),fdsDemo.Utils.TimerUtilities={},_.extend(f.prototype,{buildTimerDelegator:function(){return this.TimerDelegator||(this.TimerDelegator=a.extend(this.timerMethods())),this.TimerDelegator},timerMethods:function(){if(!this.methods){this.methods={};var b=_.difference(_.functions(this.timer),_.functions(a.prototype));c(this.timer,b,this.methods)}return this.methods},createTimerDelegator:function(){var a=new this.TimerDelegator(this);return this.timerDelegators.push(a),a},start:function(){this.allTimerDelegatorsRunning()&&this.timer.startTimer()},stop:function(){this.timer.stopTimer()},allTimerDelegatorsRunning:function(){return _.all(this.timerDelegators,b)}}),fdsDemo.Utils.TimerUtilities.MultiSwitchedTimer=f,fdsDemo.Utils.TimerUtilities.MultiplexedTimer=g}(),fdsDemo.Utils=fdsDemo.Utils||{},function(){"use strict";fdsDemo.Utils.ChartCustomizations={volumeColors:["#02A5D9","#9ACAF3","#436BB2","#B19BDA","#8255A9","#E6D6A2","#DEB211","#BD6F0F","#468F6E","#91C697","#F2FFD2"]}}(),fdsDemo.Charts=fdsDemo.Charts||{},function(){"use strict";var a={xAxisSteps:30,maxY:100,width:600,height:120,margin:{top:20,right:20,bottom:40,left:75}};fdsDemo.Charts.RealTimeStackedChart=function(){this.initialize.apply(this,arguments)},_.extend(fdsDemo.Charts.RealTimeStackedChart.prototype,a,{initialize:function(a){var b=this;this.xAxisLabel=a.xAxisLabel,this.data=[],this.trackedVolumes={},this.isRendered=!1,this.hasRenderedData=!1,this.container=null,this.x=d3.scale.linear().range([this.width+this.margin.left+this.margin.right,0]).domain([0,this.xAxisSteps]),this.y=d3.scale.linear().range([this.height,0]).domain([0,this.maxY]),this.color=d3.scale.category10().range(fdsDemo.Utils.ChartCustomizations.volumeColors),this.xAxis=d3.svg.axis().scale(this.x).orient("bottom").tickFormat(function(a){return a===b.xAxisSteps?a+" seconds ago":0===a?"now":void 0}),this.yAxis=d3.svg.axis().scale(this.y).orient("left").ticks(3),this.area=d3.svg.area().interpolate("basis").x(function(a,c){return b.x(c)}).y0(function(a){return b.y(a.y0)}).y1(function(a){return b.y(a.y0+a.y)}),this.stack=d3.layout.stack().values(function(a){return a.values})},addData:function(a){var b=this;if(a&&_.keys(a).length){a=_.extend({},a);var c=this._syncVolumes(a);for(c&&this.color.domain(d3.keys(this.trackedVolumes)),this.data.unshift(a);this.data.length>this.xAxisSteps+1;)this.data.pop();this.volumes=this.stack(this.color.domain().map(function(a){return{name:a,values:b.data.map(function(b){return{y:b[a]}})}})),this.isRendered||this.render(),!this.hasRenderedData&&this.data.length&&this.renderData(),this.updateArea()}},render:function(){if(!this.isRendered){this.svg=d3.select(this.container).append("svg").attr("width","100%").attr("height",this.height+this.margin.top+this.margin.bottom).append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.xAxisText=this.svg.append("g").attr("class","x axis").attr("transform","translate(0,"+(this.height+10)+")").style({fill:"#C8C8C8",stroke:"none"}).call(this.xAxis),this.yAxisText=this.svg.append("g").attr("class","y axis").style({fill:"#C8C8C8",stroke:"none"}).call(this.yAxis),this.xAxisTextNode=this.xAxisText.append("text").attr("x",this.width/2).attr("y",19).style("text-anchor","middle").text(this.xAxisLabel),this.resize(),this.isRendered=!0}},renderData:function(){if(!this.hasRenderedData){var a=this;this.volumes=this.stack(this.color.domain().map(function(b){return{name:b,values:a.data.map(function(a){return{y:a[b]}})}})),this.volume=this.svg.selectAll(".volumes").data(this.volumes).enter().append("g").attr("class","volume"),this.paths=this.volume.append("path").attr("class","area").style("fill",function(b){return a.color(b.name)});var b=this.svg.append("g").attr("class","legend");b.selectAll(".legend").data(this.volumes).enter().append("rect").attr("x",-1*this.margin.left).attr("y",0).attr("width",15).attr("height",15).style("fill",function(b){return a.color(b.name)}).attr("transform",function(b,c){var d=parseInt(this.getAttribute("height")),e=d*(c+1);return"translate(0,"+(a.height-e)+")"}),this._registerTooltip(),this.hasRenderedData=!0}},updateArea:function(){var a=this;this.svg.selectAll("path.area").data(this.volumes).attr("d",function(b){return a.area(b.values)})},resize:function(){this.width=$(this.container).width()-this.margin.left-this.margin.right;var a=this.width-50;this.xAxisTextNode.attr("x",a/2),this.x.range([this.width,10]),this.xAxisText.attr("transform","translate(0,"+(this.y(0)+10)+")").call(this.xAxis),this.xAxisText.selectAll("g.tick").select("text").style("text-anchor","start"),this.xAxisText.selectAll("g.tick").filter(function(a){return 0===a}).select("text").style("text-anchor","end")},_registerTooltip:function(){var a=this;$(this.container).find("svg .legend").tooltip({html:!0,container:"body",placement:"auto right",title:function(){var b=a.color.domain(),c=b.map(function(c,d){var e=a.color(b[d]);return'<li><span class="block" style="background: '+e+'"></span>'+c+"</li>"});return $("<div />").append($("<span />").text("Volumes"),$("<ul />").html(c))}})},_backfillDataForVolume:function(a){this.trackedVolumes[a]=!0;for(var b=0;b<this.data.length;b++)this.data[b][a]=0},_syncVolumes:function(a){var b=!1;for(var c in a)c in this.trackedVolumes==!1&&(this._backfillDataForVolume(c),b=!0);for(var d in this.trackedVolumes)d in a==!1&&(a[d]=0,b=!0);return b}})}(),function(){"use strict";fdsDemo.Models=fdsDemo.Models||{},fdsDemo.Models.Search=Backbone.Model.extend({defaults:{q:""},url:"/demo/search",initialize:function(a){return this.options=a,this.deferred=this.fetch()},_updateDisplayText:function(){},submit:function(a){var b=this,c={};return _.each(a,function(a){return c[a.name]=a.value}),c.q?this.save(null,{wait:!0,emulateJSON:!0,data:c,success:function(){return b.set(c)},error:function(){return b.set("q","PLEASE TRY AGAIN")}}):(this.set("q","PLEASE TRY AGAIN"),$.Deferred())}})}(),function(){fdsDemo.Models=fdsDemo.Models||{},fdsDemo.Models.Adapter=Backbone.Model.extend({buttons:[{name:"S3 API",type:"apiS3"},{name:"Amazon S3",type:"amazonS3"},{name:"Swift",type:"swift"}],defaults:{type:""},url:"/demo/adapter",initialize:function(a){return this.options=a,this.deferred=this.fetch()},submit:function(a){var b,c,d=this;return b=this.save(null,{wait:!0,emulateJSON:!0,data:a,success:function(){return d.set(c)},error:function(){return d.set("q","PLEASE TRY AGAIN")}})}})}.call(this),function(){"use strict";fdsDemo.Models=fdsDemo.Models||{},fdsDemo.Models.Throttle=Backbone.Model.extend({defaults:{value:0,unit:"IO operations/s",max_value:20},baseUrl:"demo/throttle",validMethods:["reads","writes"],initialize:function(a){return this.options=a,this.validateMethod(),this.deferred=this.fetch()},url:function(){return""+this.baseUrl+"/"+this.method},update:function(a){var b=this;return this.newValue=a,$.ajax({type:"POST",url:""+this.url()+"/"+a,dataType:"json",success:function(){return b.set("value",b.newValue)},error:function(){return b.trigger("change")}})},validateMethod:function(){if(_.contains(this.validMethods,this.options.method))return this.method=this.options.method;if(!_.contains(this.validMethods,options.method))throw new Error("Must Init with Valid Method")}})}.call(this),fdsDemo.Models=fdsDemo.Models||{},function(){"use strict";fdsDemo.Models.Stats=Backbone.Model.extend({url:"/demo/stats"},{each:function(a,b){var c=this;_.each(a,function(a){var d=c.operation(a.operation),e=a.values,f=a.unit;b(d,e,f)})},operation:function(a){return this.operations_map[a||"none"]},operations_map:{"Read performance":"read","Write performance":"write",none:"none"}})}(),fdsDemo.Models=fdsDemo.Models||{},function(){"use strict";fdsDemo.Models.ReadImage=Backbone.Model.extend({url:"/demo/peekReadQueue",initialize:function(a){this.options=a}})}(),fdsDemo.Models=fdsDemo.Models||{},function(){"use strict";fdsDemo.Models.WriteImage=Backbone.Model.extend({url:"/demo/peekWriteQueue",initialize:function(a){this.options=a}})}(),fdsDemo.Collections=fdsDemo.Collections||{},function(){"use strict";fdsDemo.Collections.ImageRead=Backbone.Collection.extend({model:fdsDemo.Models.ReadImage,initialize:function(a){this.options=a}})}(),fdsDemo.Collections=fdsDemo.Collections||{},function(){"use strict";fdsDemo.Collections.ImageWrite=Backbone.Collection.extend({model:fdsDemo.Models.WriteImage,initialize:function(a){this.options=a}})}(),fdsDemo.Views=fdsDemo.Views||{},function(){"use strict";fdsDemo.Views.SectionView=Backbone.View.extend({template:JST["app/scripts/templates/section.jst"],className:"section row",initialize:function(a){_.extend(this,_.pick(a,"timer","throttle","stats","name","xAxisText","app")),this.subViews={settings:new fdsDemo.Views.SettingsView({model:this.throttle,timer:this.timer}),flow:new fdsDemo.Views.IOFlow({collection:this.collection,timer:this.timer,name:this.name}),graph:new fdsDemo.Views.GraphView({xAxisText:this.xAxisText})},this.listenTo(this.app,"rendered",this.renderGraph)},resize:function(a){this.subViews.graph.resize(a)},render:function(){var a=this.template({name:this.name});return this.$el.html(a),this.$(".settings").append(this.subViews.settings.render().$el),this.$(".image-carousel").append(this.subViews.flow.render().$el),this},renderGraph:function(){var a=Math.round(1e3*Math.random());this.$(".graphs").addClass("g"+a),this.subViews.graph.setContainer(".g"+a),this.subViews.graph.render()},enqueueSpotStats:function(a){this.subViews.graph.setValue(a)}})}(),fdsDemo.Views=fdsDemo.Views||{},function(){fdsDemo.Views.IOFlow=Backbone.View.extend({template:JST["app/scripts/templates/flow.jst"],itemTemplate:JST["app/scripts/templates/image_item.jst"],maxIOFlow:10,className:"io-outer",initialize:function(a){_.extend(this,_.pick(a,"timer")),_.bindAll(this,"renderItem","getModel"),this.listenTo(this.collection,"add",this.renderItem),this.listenTo(this.collection,"reset",this.clearAndRender),this.listenTo(this.timer,"tick",this.tick);var b=150;this.maxIOFlow=Math.floor($(window).width()/b)},tick:function(){this.getModel()},getModel:function(){var a=this,b=new this.collection.model;b.fetch().done(function(){a.collection.add(b)})},clearAndRender:function(){this.$el.empty(),this.render()},render:function(){return this.$el.html(this.template()),this.collection.each(this.renderItem),this},renderItem:function(a){var b=a.toJSON();if(b.url){var c=this.$(".ioflow"),d=c.children(),e=d.last();if(e.length){var f=e.find("img").first().attr("src");if(f===b.url)return}var g=this.itemTemplate({model:b});c.append(g),d.length>this.maxIOFlow&&d.first().remove()}}})}(),fdsDemo.Views=fdsDemo.Views||{},function(){"use strict";fdsDemo.Views.SettingsView=Backbone.View.extend({template:JST["app/scripts/templates/settings_view.jst"],PER_RATE:1e4,events:{"slideStop .slider":"updateSlider"},initialize:function(a){_.bindAll(this,"updateSlider","setInterval"),_.extend(this,_.pick(a,"model","timer")),this.listenTo(this.model,"change",this.setIntervalFromModel),this.listenTo(this.model,"change",this.render)},render:function(){return this.$el.html(this.template({model:this.model})),this.slider=this.$(".slider").slider(),this},updateSlider:function(){var a=$('<span class="glyphicon glyphicon-refresh spinning">'),b=this.slider.slider("getValue");return this.$(".value").html(a),this.setInterval(b),this.model.update(b)},setIntervalFromModel:function(){this.setInterval(this.model.get("value"))},setInterval:function(a){a=Math.abs(a),a?(this.timer.setInterval(this.PER_RATE/a),this.timer.startTimer()):this.timer.stopTimer()}})}(),fdsDemo.Views=fdsDemo.Views||{},function(){"use strict";fdsDemo.Views.GraphView=Backbone.View.extend({initialize:function(a){this.chart=new fdsDemo.Charts.RealTimeStackedChart({xAxisLabel:a.xAxisText})},resize:function(a){this.chart.resize(a)},render:function(){return this.chart.render(),this},update:function(){this.val&&this.chart.addData(this.val)},setValue:function(a){this.val=_.extend(this.val||{},a),this.update()},setContainer:function(a){this.chart.container=a}})}(),fdsDemo.Views=fdsDemo.Views||{},function(){"use strict";fdsDemo.Views.HeaderView=Backbone.View.extend({template:JST["app/scripts/templates/header.jst"],searchTemplate:JST["app/scripts/templates/search.jst"],adapterTemplate:JST["app/scripts/templates/adapter.jst"],className:"search row",events:{"submit form":"submit","click .btn-fds":"submitAdapter"},initialize:function(a){_.extend(this,_.pick(a,"timer","search","adapter")),this.adjustTimer(),_.bindAll(this,"adjustTimer","submit"),this.listenTo(this.adapter,"change",this.renderAdapter),this.listenTo(this.search,"change",this.renderSearch),this.listenTo(this.search,"change",this.adjustTimer)},render:function(){return this.$el.html(this.template()),this.renderSearch(),this.renderAdapter(),this},renderSearch:function(){var a=this.search.get("q"),b=a?"Search phrase: "+a:"Search to view streaming images",c=this.searchTemplate({model:this.search,displayText:b});this.$("#search-container").html(c)},renderAdapter:function(){var a=this.adapterTemplate({model:this.adapter});this.$("#adapter-container").html(a)},submit:function(a){a.preventDefault();var b=$(a.currentTarget).serializeArray();return this.timer.stopTimer(),this.search.submit(b).then(this.adjustTimer)},submitAdapter:function(a){a.preventDefault();var b={};return b.type=$(a.currentTarget).attr("name"),this.timer.stopTimer(),this.adapter.submit(b).then(this.adjustTimer)},adjustTimer:function(){this.search.get("q")?this.timer.startTimer():this.timer.stopTimer()}})}(),fdsDemo.Views=fdsDemo.Views||{},function(){"use strict";var a=fdsDemo.Utils.TimerUtilities.MultiSwitchedTimer,b=fdsDemo.Utils.TimerUtilities.MultiplexedTimer;fdsDemo.Views.ApplicationView=Backbone.View.extend({template:JST["app/scripts/templates/application.jst"],initialize:function(){var c=this;this.readCollection=new fdsDemo.Collections.ImageRead,this.writeCollection=new fdsDemo.Collections.ImageWrite,this.timers={read:new fdsDemo.Utils.Timer,write:new fdsDemo.Utils.Timer},this.mainTimer=new fdsDemo.Utils.Timer({interval:1e3}),this.mainTimer.stopTimer(),this.listenTo(this.mainTimer,"tick",this.tick),this.delegates={readTimer:new a(this.timers.read),writeTimer:new a(this.timers.write)},this.delegates.searchTimer=new b([this.delegates.readTimer.createTimerDelegator(),this.delegates.writeTimer.createTimerDelegator(),this.mainTimer]),this.models={search:new fdsDemo.Models.Search,adapter:new fdsDemo.Models.Adapter,throttleReads:new fdsDemo.Models.Throttle({title:"Reads",method:"reads"}),throttleWrites:new fdsDemo.Models.Throttle({title:"Writes",method:"writes"}),stats:new fdsDemo.Models.Stats},this.views={headerView:new fdsDemo.Views.HeaderView({search:this.models.search,adapter:this.models.adapter,timer:this.delegates.searchTimer}),readSection:new fdsDemo.Views.SectionView({collection:this.readCollection,throttle:this.models.throttleReads,stats:this.models.stats,timer:this.delegates.readTimer.createTimerDelegator(),xAxisText:"images read per second (by volume)",app:this}),writeSection:new fdsDemo.Views.SectionView({collection:this.writeCollection,throttle:this.models.throttleWrites,stats:this.models.stats,timer:this.delegates.writeTimer.createTimerDelegator(),xAxisText:"images written per second (by volume)",app:this})},$(window).resize(_.throttle(function(){var a=$(window).width();c.views.readSection.resize(a),c.views.writeSection.resize(a)},500))},tick:function(){var a=this;$.get("/demo/pollStats",function(b){fdsDemo.Models.Stats.each(b,function(b,c){var d=a.views[b+"Section"];d&&d.enqueueSpotStats(c)})})},render:function(){return this.$el.html(this.template()),this.$("#sections").append(this.renderedViews()),this.trigger("rendered"),this},renderedViews:function(){return _.map(this.views,function(a){return a.render().$el})}})}();