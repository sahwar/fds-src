<html>
    
    <head>
        <script type="text/javascript" src="libs/jquery/dist/jquery.min.js"></script>
        <script type="text/javascript">
            
            var token = undefined;
            var lastTime = 0;
            
            var start = function(){
                $.post( '/fds/config/v08/token?login=admin&password=admin',
                        null,
                        function( data ){
                            token = data.token;
                        });
            };
            
            var getStats = function(){
                
                $.ajax( {
                    url: '/fds/config/v08/stats/stream?lastTime=' + lastTime,
                    method: 'post',
                    dataType: 'json',
                    headers: {
                        'FDS-Auth': token
                    }
                })
                .done( 
                    function( stats ){
                            
                        var pointElem = $('#points');

                        for ( var i = 0; i < stats.newPoints.length; i++ ){
                            
                            var when = new Date( stats.newPoints[i].reportTime );
                            var dateStr = when.toDateString() + ' ' + when.toTimeString();
                            
                            pointElem.append( '<div><span>'+ dateStr  + '&nbsp;</span><span>' + stats.newPoints[i].metricName + ':&nbsp;</span><span>' + stats.newPoints[i].metricValue + '</span></div>' );
                        }
                        
                        lastTime = (new Date()).getTime();
                    }
                );
            };
            
            setInterval( getStats, 5000 );
            
        </script>
    </head> 
    <body onload="start()">
        <div id="points">
        </div>

    </body>  
</html>
